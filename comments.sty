%%
%% This is file `comments.sty',
%%
%% Copyright (C) 1991 -- 2004 by Torsten Schaub,
%%                            all rights reserved.
%% Please report errors to: Torsten Schaub
%%                          torsten@cs.uni-potsdam.de
\ProvidesPackage{comments}[2001/03/09 v0.7 The comments package]
\RequirePackage[normalem]{ulem}
\RequirePackage{color}

\def\MFONT{\scriptsize\rm}
\def\BFONT{\scriptsize\it}

%\@mparswitchfalse
\setlength{\marginparwidth}{29mm}               % Breite
\setlength{\marginparsep}{1mm}                  % Abstand vom Rand
\setlength{\marginparpush}{0mm}                 % space between 2 marginpars
\setlength{\fboxsep}{.1mm}
\newlength{\@commentparboxwidth}
\setlength{\@commentparboxwidth}{\textwidth}
\addtolength{\@commentparboxwidth}{-2\fboxsep}
\addtolength{\@commentparboxwidth}{-2\fboxrule}

%% -- counters --------------------------------------------------
\newcounter{commentctr}

%% -- ulem-based commands ---------------------------------------
\newcommand{\CHD}[1]{\uwave{#1}\COM{CHANGED}}
\newcommand{\comwave}[2]{\uwave{#1}\COM{#2}}

\newcommand{\DELETE}[2]{\sout{#1}\COM{DELETE{#2}}}
\newcommand{\DEL}[1]{\DELETE{#1}{\ignorespaces}}
\newcommand{\DELc}[2]{\DELETE{#1}{\par {#2}}}
\newcommand{\DELed}[1]{\COM{DELETED}}
\newcommand{\DELced}[2]{\ignorespaces\COM{DELETED}}
\newcommand{\noDEL}[2]{{#1}\ignorespaces\COM{NOT~DELETED}}

\newcommand{\INSERT}[2]{\uline{#1}\COM{INSERT{#2}}}
\newcommand{\INS}[1]{\INSERT{#1}{\ignorespaces}}
\newcommand{\INSc}[2]{\INSERT{#1}{\par {#2}}}
\newcommand{\INSed}[1]{{#1}\COM{INSERTED}}
\newcommand{\INSced}[2]{{#1}\COM{INSERTED}}

\newcommand{\REWRITE}[2]{\uwave{#1}\COM{REWRITE{#2}}}
\newcommand{\REW}[1]{\REWRITE{#1}{\ignorespaces}}
\newcommand{\REWc}[2]{\REWRITE{#1}{\par {#2}}}

\newcommand{\REPLACE}[3]{\sout{#1}\COM{REPLACE{#3}}\uline{#2}}
\newcommand{\REP}[2]{\REPLACE{#1}{#2}{\ignorespaces}}
\newcommand{\REPc}[3]{\REPLACE{#1}{#2}{\par {#3}}}
\newcommand{\REPed}[2]{\ignorespaces\COM{REPLACED}{#2}}
\newcommand{\REPced}[3]{\ignorespaces\COM{REPLACED}{#2}}
\newcommand{\noREP}[2]{{#1}\COM{NOT~REPLACED}}

%% -- commands --------------------------------------------------
\newcommand{\com}[1]%
{\message{Attention ... #1 ...}%
  \mbox{}\\ 
  \noindent
  \framebox[\linewidth][c]{\stepcounter{commentctr}{\BFONT\textcolor{red}{\thecommentctr}: #1}}
  \ignorespaces
}
% --------------------------------------------------
\newcommand{\compar}[1]%
{\message{Attention ... #1 ...}%
  \framebox[\linewidth]{\parbox{\@commentparboxwidth}{\stepcounter{commentctr}{\BFONT\textcolor{red}{\thecommentctr}: #1\ignorespaces}}}}
% --------------------------------------------------
\newcommand{\MCOM}[1]%
{%
  {\setlength{\fboxsep}{1pt}%
    \marginpar{\raggedright\hspace{0pt}\MFONT{\setstretch{1}#1}\par}%
    }%
  \ignorespaces}
% --------------------------------------------------
\newcommand{\COM}[1]%
{%
  \def\@currentlabel{\thecommentctr}% TS 04/06/18 (found in latex.lst)
  \stepcounter{commentctr}%
  \MCOM{\raisebox{.1ex}{\textcolor{red}{\framebox{\rm\thecommentctr}}}\ #1\par}%
  {\setlength{\fboxsep}{1pt}%
    \raisebox{.3ex}{\textcolor{red}{\tiny\framebox{\rm\thecommentctr}}}%
    }%
  \message{Attention ... COMMENT *\thecommentctr* ...}%
  \ignorespaces}
% --------------------------------------------------
\newcommand{\new}[1]{#1\COM{NEW!}}
% --------------------------------------------------
\newcommand{\tbf}{\com{TO BE FILLED}}
\newcommand{\tbfc}[1]{\MCOM{#1}\tbf}
%
\newcommand{\tbr}{\com{TO BE REFINED}}
\newcommand{\tbrc}[1]{\MCOM{#1}\tbr}
%
\newcommand{\tbc}{\com{TO BE COMPLETED}}
\newcommand{\tbcc}[1]{\MCOM{#1}\tbc}
%
\newcommand{\tbrw}{\com{TO BE REWRITTEN}}
\newcommand{\tbrwc}[1]{\MCOM{#1}\tbrw}
%
\newcommand{\comc}[2]{\MCOM{#2}\com{#1}}

\AtEndDocument{\par
{\vfill\noindent%
This article was processed using the comments style on \today.\\
There remain \thecommentctr\ comments to be processed.}
\message{*** THERE ARE *\thecommentctr* COMMENTS ***}}
